From 5ed4d790cf1ed941fddd9ca979104bb3b9d4325f Mon Sep 17 00:00:00 2001
From: Steven Fisher <steven.fisher@globalinvacom.com>
Date: Wed, 23 Oct 2019 16:21:58 -0400
Subject: [PATCH] Make ios builds have libgles by default

---
 modules/video_output/Makefile.am | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/modules/video_output/Makefile.am b/modules/video_output/Makefile.am
index a5b59f911a..d2b206954c 100644
--- a/modules/video_output/Makefile.am
+++ b/modules/video_output/Makefile.am
@@ -74,8 +74,15 @@ libgles2_plugin_la_CFLAGS = $(AM_CFLAGS) $(GLES2_CFLAGS) -DUSE_OPENGL_ES2 $(OPEN
 libgles2_plugin_la_LIBADD = $(GLES2_LIBS) $(LIBM) $(OPENGL_COMMONLIBS)
 libgles2_plugin_la_LDFLAGS = $(AM_LDFLAGS) -rpath '$(voutdir)'
 
+if HAVE_IOS
+libgles2_plugin_la_LDFLAGS += -Wl,-framework,IOSurface \
+	-Wl,-framework,Foundation,-framework,CoreVideo,-framework,OpenGL
+
+vout_LTLIBRARIES += libgles2_plugin.la
+else
 EXTRA_LTLIBRARIES += libgles2_plugin.la
 vout_LTLIBRARIES += $(LTLIBgles2)
+endif
 
 libgl_plugin_la_SOURCES = $(OPENGL_COMMONSOURCES) video_output/opengl/display.c
 libgl_plugin_la_CFLAGS = $(AM_CFLAGS) $(GL_CFLAGS) $(OPENGL_COMMONCFLAGS)
@@ -85,6 +92,12 @@ libgl_plugin_la_CFLAGS += -DHAVE_GL_CORE_SYMBOLS
 libgl_plugin_la_LIBADD += $(GL_LIBS)
 endif
 
+
+
+
+
+
+
 libglconv_vaapi_plugin_la_SOURCES = video_output/opengl/converter_vaapi.c \
 	video_output/opengl/converter.h \
 	hw/vaapi/vlc_vaapi.c hw/vaapi/vlc_vaapi.h
-- 
2.21.0 (Apple Git-122)

